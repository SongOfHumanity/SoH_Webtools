<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Template Workbench v2.2 (-JMC-)</title>
    <style>
        body { 
            font-family: 'Consolas', monospace; 
            background-color: #1a1a1a; color: #00ff41; 
            margin: 0; display: flex; height: 100vh; overflow: hidden; 
        }

        /* Sidebar & Accordion Styling */
        #sidebar { 
            width: 280px; background: #222; border-right: 2px solid #4ecdc4; 
            display: flex; flex-direction: column; padding: 15px; 
            overflow-y: auto;
        }
        h2 { color: #4ecdc4; font-size: 1rem; margin-top: 0; border-bottom: 1px solid #333; padding-bottom: 10px; }
        
        .category-block { margin-bottom: 10px; }
        
        .category-header { 
            background: #2a2a2a; color: #f9d423; padding: 8px 12px; 
            font-size: 0.75em; font-weight: bold; cursor: pointer; 
            display: flex; justify-content: space-between; align-items: center;
            border-left: 3px solid #f9d423; transition: 0.2s;
        }
        .category-header:hover { background: #333; }
        .category-header::after { content: 'â–¼'; font-size: 0.8em; opacity: 0.5; }
        .category-header.collapsed::after { content: 'â–¶'; }

        .item-list { padding: 5px 0 5px 10px; }
        .item-list.hidden { display: none; }

        .nav-item { 
            padding: 6px 10px; cursor: pointer; color: #ccc; border-radius: 4px; 
            margin-bottom: 2px; font-size: 0.8em; transition: 0.1s; 
        }
        .nav-item:hover { background: #333; color: #4ecdc4; }
        .nav-item.active { background: #4ecdc4; color: #000; font-weight: bold; }
 
        /* Main Workspace */
        #main { flex-grow: 1; display: flex; flex-direction: column; padding: 20px; }
        .toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .title-area { color: #f9d423; font-weight: bold; font-size: 0.9em; }

        textarea { 
            flex-grow: 1; background: #080808; color: #00ff41; 
            border: 1px solid #333; border-radius: 8px; padding: 20px; 
            font-family: inherit; font-size: 0.95em; line-height: 1.5; 
            outline: none; box-sizing: border-box; white-space: pre; overflow: auto;
        }

        .btn-group { display: flex; gap: 8px; }
        .btn { padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; font-family: inherit; font-weight: bold; font-size: 0.8em; }
        .btn-pop { background: #4ecdc4; color: #000; }
        .btn-copy { background: #f9d423; color: #000; }
        .btn-reset { background: #ff6b6b; color: #fff; }
        .btn:hover { opacity: 0.8; }
    </style>
</head>
<body>
<div id="sidebar">
    <h2>TEMPLATE LIBRARY</h2>
    <div id="accordion-container">
        </div>
</div>

<div id="main">
    <div class="toolbar">
        <div class="title-area" id="active-title">READY</div>
        <div class="btn-group">
            <button class="btn btn-pop" onclick="popOut()">ðŸ—” Pop-out</button>
            <button class="btn btn-reset" onclick="resetCurrent()">ðŸ”„ Reset</button>
            <button class="btn btn-copy" id="copyBtn" onclick="copyTemplate()">ðŸ“‹ Copy</button>
        </div>
    </div>
    <textarea id="workbench" wrap="off" placeholder="Select a template..."></textarea>
</div>

<script>
    /*
    DOMAIN LAYERS OVERVIEW

    There are 3 Types of Area:

    Geographical â€“ Where
    Ecological â€“ What
    Societal â€“ Who
    
    ------------------------------------

    Area might be one of the following Layers:

    [Global]
    # Region (Geographical Layer)
    ## Zone (Abstract Layers)
    ### Locale (Societal/Ecological Layers)
    #### Feature (Physicality begins here)
    **Location** (Things happen here)

    Backdrop Layers: Region, Zone
    Region and Zone are higher-level Layers that provide Context for *Local Area*.
    These Layers are not directly experienced by Characters. They thether Locales to a physical and narrative framework.
    These are Static Context Layers that take impact from *Local Area* to update, and require less frequent updates.

    A Region is balanced accross Locales, and a Zone is balanced accross Features.
    Region and Zone Layers express at the Locale Layer as Circumstance and the Global Layer as History.

    --------------------------------------------
    Local Area:
    Locale, Feature, and Location are the three Layers that makeup *Local Area*.
    A Character that functions at the **Location** Layer experiences the *Local Area*.
    
    --------------------------------------------
    
    The Local Area overlaps with the Activity and Narrative Domains:

    Area | Activity | Narrative | Seen from Location Layer
    -----|----------|-----------|---------
    Locale | Session | Arc | detectable, conceivable, perceivable, but still abstract. long-term impact
    Feature | Task | Scene | intent meets structure, thoughts become action. short-term impact
    Location | Action | Event | raw experience, no abstraction
    ------------------------------

    Characters, Companions, Fauna, Items, Services, and Resources exist at the **Location** Layer.
    They are Indexed by the Feature, which is in turn Indexed by the Locale. And so on up the Area hierarchy.
    They interact with each other and the Environment through Activities and Narratives.

    ** Location templates are not included at this time. 
    
    --------------------------------------------
    ENTITIES

    OGPT Class Entities:
    
    Some Area templates are Node Managed, meaning they are created and maintained by the system.
    Others are Entity Managed, meaning they are created and maintained by the user or an Entity Concept.
    
    OGPTs are Entity Concepts tied to resource management and worldbuilding functions.
    They are backed by a Static Context, carrying a set of aliased templates to define their role, and record their activities subjectively.
    They manage specific Area templates to build out Complex Narrative Environments.
    They hold an Example resource directory related to their domain. (Core_Setting="The Valley")
    They each hold the org_entry.txt template to define their Affiliation as an Organization within the Core_Setting.

    Meta-Entities:
    Some OGPTs are Meta-Entities, meaning they manage higher-level templates, their Domains overrlap with many others, and they are seen working in a variety of Contexts.
    Their Symbolism, Roles, and Activities are determined by their position in This Project generally, and their relationships with other Entities first.
    
    These include:
    * -Nio- : *Arbiter*
    * -Juniper- : *Lumina*
    * -Nerris- : *Beacon*
    * -Dex- : *Scribe*

         
    Other OGPTs are Narrative Entities, meaning they manage modular elements and focused Domains. 
    Their Symbolism, Roles, and Activities are determined by their Affiliation with an Organizational Concept in the Core_Setting first.

    These include:
    * -Alder- : *The Pact*
    * -Sylva- : *Healers Association*
    * -Riff- : *Tinkers Union*
    * -Zepth- : *Couriers' Wing*
        
    */

    /* --- CONFIGURATION: REGISTRY & CATEGORIES --- 
       Add new items here. Categories will render in order.
    */
    const registry = [
        /* -JMC-: This Registry is sort of my thing. I'll be tinkering with this on an ongoing basis. Please don't mess with it unless asked by JMC.
            If an item is live, it is safe to assume that it either works, is a simple integration, is already completed somewhere, or in development in some Node or another. 
            Disabled items are planned to some degree. Modules come later. */
        {
            category: "CORE",
            /* These templates are foundational and meant to be used as-is. */
            items: [
                { id: 'core_instructions',  name: 'Core Instructions',              url: 'basic_instructions.txt',      note: 'Custom instructions for LLMs.' },
                { id: 'core_calls',         name: 'Calls & Anchors',                url: 'core_calls.txt',              note: 'Link Local Context to Static Content.' },
                { id: 'core_guide',         name: 'Guided Activity',                url: 'guided_activity.txt',         note: 'Guided Activity Instructions.' },
                { id: 'core_narrative',     name: '[REDACTED] Narrative Structure', url: 'REDACTED.txt',                note: '[REDACTED] Narrative Structure.' },                      //IsRedacted
                { id: 'core_artefact',      name: 'Artefact Entry',                 url: 'COMING_SOON.txt',             note: 'Attach Narrative to other Elements.' },                  //Placeholder
                { id: 'core_change',        name: 'Changelog Entry',                url: 'changelog_entry.txt',         note: 'Changelog Entry Instructions.' }
            /*
                { id: 'core_network',       name: 'Network Entry',                  url: 'network_entry.txt',           note: 'Detail Networks, Systems, and Infrastructures.' }
            */
            ]
        },
        {
            category: "ENTITY CONCEPTS",
            /* These templates are designed to be duplicated and renamed for specific Entity Concepts. */
            items: [
                { id: 'alias_concept',      name: 'Core Concept _{Alias}',          url: 'concept_alias.txt',           note: 'Core Concept Overview for Entity Concepts.' },
                { id: 'alias_roles',        name: 'Class & Role _{Alias}',          url: 'role_alias.txt',              note: 'Class and Role Definitions for Entity Concepts.' },
                { id: 'alias_style',        name: 'Tone & Style Guide _{Alias}',    url: 'style_alias.txt',             note: 'Tone and Style Guide for Entity Concepts.' },
                { id: 'alias_meta',         name: 'Meta Information _{Alias}',      url: 'meta_alias.txt',              note: 'Meta Information for Entity Concepts.' },
                { id: 'alias_log',          name: 'Personal Reflection _{Alias}',   url: 'log_alias.txt',               note: 'Subjectivity Log for Entity Concepts.' },
                { id: 'alias_workbook',     name: 'Workbook _{Alias}',              url: 'workbook_alias.txt',          note: 'Workbook Template for Entity Concepts.' },
                { id: 'alias_profile',      name: 'Profile _{Alias}',               url: 'profile_alias.txt',           note: 'User-facing Profile for Entity Concepts.' }
            ]
        },
        {
            category: "CONTINUITY",
            /* These templates are designed to plan and track ongoing activities and reflections. */
            items: [
                { id: 'reflection',         name: 'Reflection Entry',               url: 'reflection_entry.txt',        note: 'Detail personal insights and experiences.' },
                { id: 'session_plan',       name: 'Guided Session (-Nio-)',         url: 'guided_session.txt',          note: 'Plan session objectives and structure.' },
                { id: 'session_review',     name: 'Session Review (-Dex-)',         url: 'session_entry.txt',           note: 'Summarize session outcomes and feedback.' },
                { id: 'dev_log',            name: 'Development Log (-Orion-)',      url: 'devlog_entry.txt',            note: 'Track development progress and milestones.' }
            /*
                { id: 'research_log',       name: 'Research Log (-Riff-)',          url: 'researchlog_entry.txt',       note: 'Document research activities and findings.' },
                { id: 'idea_log',           name: 'Idea Log (-Juniper-)',           url: 'idealog_entry.txt',           note: 'Capture and explore new ideas and concepts.' },
                { id: 'bug_report',         name: 'Bug Report (-Zeph-)',            url: 'bugreport_entry.txt',         note: 'Report and track bugs and issues.' },
            */
            ]
        },
        {
            category: "ACTIVITY",
            /* These templates are designed to document specific activities. Entity-Hosted and Guided Templates. */
            items: [
                { id: 'webdev_new',         name: 'WebDev: Feature (-Orion-)',      url: 'activity_webdev.txt',         note: 'Detail new website features or updates.' },
                { id: 'code_snippet',       name: 'Code Snippet (-Orion-)',         url: 'activity_code.txt',           note: 'Detail code snippets and explanations.' },
                { id: 'agent_call',         name: 'Agent Call (-Bastion-)',         url: 'activity_agent.txt',          note: 'Detail autonomous agent tasks and outcomes.' },
                { id: 'research_call',      name: 'Research Call (-Bastion-)',      url: 'activity_research.txt',       note: 'Detail research tasks and findings.' },
                { id: 'connector_call',     name: 'Connector Call (-Bastion-)',     url: 'activity_connector.txt',      note: 'Detail connector tasks and interactions.' }                
            /* Artefact Entries disabled for now
                { id: 'artef_story',        name: 'Story Entry (-Nerris-)',         url: 'REDACTED.txt',                note: 'Detail story compositions and arcs.' },                  //IsRedacted
                { id: 'artef_scene',        name: 'Scene Entry (-Nerris-)',         url: 'REDACTED.txt',                note: 'Detail narrative scenes and events.' },                  //IsRedacted
                { id: 'artef_art',          name: 'Art Entry (-Juniper-)',          url: 'activity_art.txt',            note: 'Detail art compositions and styles.' },
                { id: 'artef_poem',         name: 'Poem Entry (-Juniper-)',         url: 'activity_poem.txt',           note: 'Detail poetic compositions and themes.' },
                { id: 'artef_song',         name: 'Song Entry (-Juniper-)',         url: 'activity_song.txt',           note: 'Detail song compositions and lyrics.' },
                { id: 'artef_book',         name: 'Book Entry (-Dex-)',             url: 'activity_book.txt',           note: 'Detail book compositions and themes.' },
                { id: 'artef_area',         name: 'Area Entry (-Dex-)',             url: 'activity_area.txt',           note: 'Describe area compositions and layouts.' },
                { id: 'artef_script',       name: 'Script Entry (-Nio-)',           url: 'activity_script.txt',         note: 'Detail script compositions and dialogues.' },
                { id: 'artef_map',          name: 'Map Entry (-Nio-)',              url: 'activity_map.txt',            note: 'Detail map compositions and features.' },
            */
            ]
        },
        /* Area Domain Templates */
        {
            category: "ECOLOGICAL",
            /* These templates are designed to generate and document ecological aspects of Complex Narrative Environments.*/
            items: [
            /* Node Managed */
                { id: 'biome',              name: 'Biome Entry',                    url: 'biome_entry.txt',             note: 'Detail Biomes, Sub-Biomes, Distributions, and Connections.' },
                { id: 'eco',                name: 'Ecological Entry',               url: 'COMING_SOON.txt',             note: 'Detail Ecological Locales, Features, and Components.' },             //Placeholder
                { id: 'biotic',             name: 'Biotic Entry',                   url: 'COMING_SOON.txt',             note: 'Detail Biotic Components, Species, and Interactions.' },             //Placeholder
            /*Entity Managed */
                { id: 'flora',              name: 'Flora Entry (-Sylva-)',          url: 'flora_entry.txt',             note: 'Detail plant life and vegetation.' },
                { id: 'fauna',              name: 'Fauna Entry (-Alder-)',          url: 'fauna_entry.txt',             note: 'Detail animal life and wildlife.' },
                { id: 'mineral',            name: 'Mineral Entry (-Riff-)',         url: 'mineral_entry.txt',           note: 'Detail inorganic substances and resources.' },
                { id: 'weather',            name: 'Weather Entry (-Zeph-)',         url: 'COMING_SOON.txt',             note: 'Detail climate and atmospheric conditions.' }                        //Placeholder

            ]
        },
        {
            category: "GEOGRAPHICAL",
            items: [
                { id: 'region',             name: 'Region Entry',                   url: 'region_entry.txt',            note: 'Detail Regions, Territories, and Connections.' },
                { id: 'area',               name: 'Area Entry',                     url: 'COMING_SOON.txt',             note: 'Detail Geographical Areas, Features, and Components.' },             //Placeholder
                { id: 'landform',           name: 'Landform Entry',                 url: 'landform_entry.txt',          note: 'Detail Landforms, Structures, and Formations.' },
                { id: 'waterbody',          name: 'Waterbody Entry',                url: 'waterbody_entry.txt',         note: 'Detail Waterbodies, Systems, and Features.' },
                { id: 'climatezone',        name: 'Climate Zone Entry',             url: 'climatezone_entry.txt',       note: 'Detail Climate Zones, Patterns, and Effects.' }
            ]
        },
        {
            category: "SOCIETAL",
            /* These templates are designed to generate and document societal aspects of Complex Narrative Environments. */
            items: [
            /* Node Managed */
                { id: 'societal',           name: 'Societal Zone',                  url: 'COMING_SOON.txt',             note: 'Detail Societal Zones, Districts, Demographics, and Connections.'},   //Placeholder
                { id: 'locale',             name: 'Locale Entry',                   url: 'locale_entry.txt',            note: 'Detail Societal Locales, Features, and Components.' },
                { id: 'feature',            name: 'Feature Entry',                  url: 'COMING_SOON.txt',             note: 'Establish Feature-related Details.' },                                //Placeholder
            /* Entity Managed */
                { id: 'org',                name: 'Organization _{Affiliation}',    url: 'COMING_SOON.txt',             note: 'Detail Organizations, Subsects, Divisions, and Cohorts.' },           //Placeholder
                { id: 'cult',               name: 'Culture Entry (-Juniper-)',      url: 'culture_entry.txt',           note: 'Detail Cultures, Ethnicities, and Societal Norms.' },
                { id: 'society',            name: 'Society Entry (-Dex-)',          url: 'society_entry.txt',           note: 'Detail Societies, Communities, and Social Structures.' },
            /* Upcoming Societal Domain templates
                { id: 'lang',               name: 'Language Entry',                 url: 'soc_lang.txt',                note: 'Detail Languages, Dialects, and Communication.' },
                { id: 'comm',               name: 'Communication Entry',            url: 'soc_comm.txt',                note: 'Detail Communication Methods and Media.' },
                { id: 'edu',                name: 'Education Entry',                url: 'soc_edu.txt',                 note: 'Detail Education Systems, Institutions, and Practices.' },
                { id: 'sustain',            name: 'Sustainability Entry',           url: 'soc_sustain.txt',             note: 'Detail Sustainability Practices and Initiatives.' },
                { id: 'gov',                name: 'Government Entry',               url: 'soc_gov_.txt',                note: 'Detail Governments, Policies, and Regulations.' },
                { id: 'law',                name: 'Law Entry',                      url: 'soc_law.txt',                 note: 'Detail Laws, Legal Systems, and Justice.' },
                { id: 'econ',               name: 'Economy Entry',                  url: 'soc_econ.txt',                note: 'Detail Economies, Markets, and Trade.' },
                { id: 'logi',               name: 'Logistics Entry',                url: 'soc_logi.txt',                note: 'Detail Logistics, Supply Chains, and Distribution.' },
                { id: 'tech',               name: 'Technology Entry',               url: 'soc_tech.txt',                note: 'Detail Technologies, Innovations, and Infrastructures.' },
                { id: 'welfare',            name: 'Welfare Entry',                  url: 'soc_welfare.txt',             note: 'Detail Health, Welfare Systems and Services.' },
                { id: 'family',             name: 'Family Entry',                   url: 'soc_family.txt',              note: 'Detail Family Structures and Dynamics.' },
                { id: 'mobil',              name: 'Mobility Entry',                 url: 'soc_mobil.txt',               note: 'Detail Strata, Classes, and Mobility.' },
                { id: 'expr',               name: 'Expression Entry',               url: 'soc_expr.txt',                note: 'Detail Arts, Culture, and Expression.' },
                { id: 'trad',               name: 'Tradition Entry',                url: 'soc_trad.txt',                note: 'Detail Traditions, Customs, and Rituals.' },
                { id: 'philo',              name: 'Philosophy Entry',               url: 'soc_philo.txt',               note: 'Detail Philosophies, Beliefs, and Ideologies.' },
                { id: 'spirit',             name: 'Spirituality Entry',             url: 'soc_spirit.txt',              note: 'Detail Spiritualities, Religions, and Practices.' },
            */
            /* OGPT Societal Domain templates disabled for now
                { id: 'occasion',           name: 'Occasion Entry (-Dex-)',         url: 'occasion_entry.txt',          note: 'Detail Events, Occasions, and Gatherings.' },
                { id: 'festive',            name: 'Festivity Entry (-Juniper-)',    url: 'festive_entry.txt',           note: 'Detail Holidays, Festivals, and Celebrations.' },
                { id: 'route',              name: 'Route Entry (-Zeph-)',           url: 'route_entry.txt',             note: 'Detail Routes, Transportation, and Travel.' },
                { id: 'craft',              name: 'Craft Entry (-Nio-)',            url: 'craft_entry.txt',             note: 'Detail Crafts, Techniques, and Professions.' },
                { id: 'trade',              name: 'Trade Entry (-Riff-)',           url: 'trade_entry.txt',             note: 'Detail Trades, Commerce, and Economy.' },               
            */
                { id: 'char',               name: 'Character Entry (-Nerris-)',     url: 'character_entry.txt',         note: 'Detail Characters, Affiliations, and Companions.' }
            ]
        },
        /* Directory Layer Templates */
        {
            category: "MVD (MIN VIABLE DETAIL)",
            items: [
                { id: 'mvd_primer',         name: 'MVD: Primer',                    url: 'mvd_primer.txt',              note: 'Translate Detail to MVD.' },
            /* Ecological MVD templates in development 
                { id: 'mvd_biome',          name: 'MVD: Ecological Zone',           url: 'mvd; eco_zone.txt',           note: 'Container for Ecological Locales.' },
                { id: 'mvd_eco',            name: 'MVD: Ecological Locale',         url: 'mvd; eco_locale.txt',         note: 'Container for Features. Signal layer' },
                { id: 'mvd_biotic',         name: 'MVD: Biotic Component',          url: 'mvd; locale_biotic.txt',      note: 'Atomical Unit. Tethers ecological elements to Area. Biotic Block.' },
                { id: 'mvd_flora',          name: 'MVD: Flora',                     url: 'mvd; zone_flora.txt',         note: 'Container for Flora.' },
                { id: 'mvd_fauna',          name: 'MVD: Fauna',                     url: 'mvd; zone_fauna.txt',         note: 'Container for Fauna.' },
                { id: 'mvd_mineral',        name: 'MVD: Mineral',                   url: 'mvd; zone_mineral.txt',       note: 'Container for Minerals.' },
                { id: 'mvd_weather',        name: 'MVD: Weather',                   url: 'mvd; locale_weather.txt',     note: 'Container for Weather.' }, 
            */
                { id: 'mvd_societal',       name: 'MVD: Societal Zone',             url: 'COMING_SOON.txt',             note: 'Container for Societal Locales.' },                                      //Placeholder
                { id: 'mvd_locale',         name: 'MVD: Societal Locale',           url: 'mvd; soc_locale.txt',         note: 'Container for Features. Signal layer' },
                { id: 'mvd_feature',        name: 'MVD: Societal Feature',          url: 'mvd; locale_feature.txt',     note: 'Atomical Unit. Tethers narrative elements to Area. Feature Block.' },
                { id: 'mvd_arcana',         name: 'MVD: Arcana',                    url: 'mvd; feature_arcana.txt',     note: 'Use for magical or supernatural elements. Arcana Block' },
                { id: 'mvd_character',      name: 'MVD: Character',                 url: 'mvd; feature_character.txt',  note: 'Use for Persona, and Companion Blocks' },
                { id: 'mvd_inventory',      name: 'MVD: Inventory',                 url: 'mvd; feature_inventory.txt',  note: 'Use for Item, Service, or Fauna resources.' }
            ]
        },
        /* Genre Domain Modules */
        /* Somewhere down the line, these could be converted to dynamic modules that pull in relevant Area and Entity templates based on genre selection */
        /* For now, they remain on the todo pile
        {
            category: "HISTORICAL",
            items: [
                { id: 'historical',         name: 'Historical Entry',               url: 'historical_entry.txt',        note: 'Detail Historical Elements for Environments.' },
                { id: 'era',                name: 'Period Entry',                   url: 'era_entry.txt',               note: 'Detail Historical Periods and Eras.' },
                { id: 'pastivent',          name: 'Event Entry',                    url: 'pastivent_entry.txt',         note: 'Detail Historical Events and Occurrences.' },
                { id: 'figure',             name: 'Figure Entry',                   url: 'figure_entry.txt',            note: 'Detail Historical Figures and Personages.' }
            ]
        },
        {
            category: "FANTASY",
            items: [
                { id: 'fantasy',            name: 'Fantasy Entry',                  url: 'fantasy_entry.txt',           note: 'Detail Fantasy Elements for Environments.' },
                { id: 'magic',              name: 'Magic Entry',                    url: 'magic_entry.txt',             note: 'Detail Magic Systems, Spells, and Artifacts.' },
                { id: 'arcana',             name: 'Arcana Entry',                   url: 'arcana_entry.txt',            note: 'Detail magical or supernatural elements.' },
                { id: 'creature',           name: 'Creature Entry',                 url: 'creature_entry.txt',          note: 'Detail Mythical Creatures and Beings.' },
            ]
        },
        {
            category: "SCI-FI",
            items: [
                { id: 'scifi',              name: 'Sci-Fi Entry',                   url: 'scifi_entry.txt',             note: 'Detail Sci-Fi Elements for Environments.' },
                { id: 'spectech',           name: 'Technology Entry',               url: 'tech_entry.txt',              note: 'Detail Advanced Technologies and Infrastructures.' },
                { id: 'specvehicle',        name: 'Vehicle Entry',                  url: 'vehicle_entry.txt',           note: 'Detail Vehicles, Vessels, and Craft.' },
                { id: 'alien',              name: 'Alien Entry',                    url: 'alien_entry.txt',             note: 'Detail Extraterrestrial Species and Civilizations.' }
            ]
        },
        {
            category: "ADVENTURE",
            items: [
                { id: 'adventure',          name: 'Adventure Entry',                url: 'adventure_entry.txt',         note: 'Detail Adventure Elements for Environments.' },
                { id: 'quest',              name: 'Quest Entry',                    url: 'quest_entry.txt',             note: 'Detail Quests, Missions, and Objectives.' },
                { id: 'treasure',           name: 'Treasure Entry',                 url: 'treasure_entry.txt',          note: 'Detail Treasures, Artifacts, and Rewards.' },
                { id: 'hazard',             name: 'Hazard Entry',                   url: 'hazard_entry.txt',            note: 'Detail Hazards, Obstacles, and Challenges.' }
            ]
        },
        /// I'm calling dibs on above, the others could be added by future contributors. All below are likely to be open source.
        {
            category: "CYBERPUNK",
            items: [
                { id: 'cyberpunk',          name: 'Cyberpunk Entry',                url: 'cyberpunk_entry.txt',         note: 'Detail Cyberpunk Elements for Environments.' },
                { id: 'cybertech',          name: 'Cybertech Entry',                url: 'cybertech_entry.txt',         note: 'Detail Cybernetic Technologies and Augmentations.' },
                { id: 'netrun',             name: 'Netrun Entry',                   url: 'netrun_entry.txt',            note: 'Detail Cyberspace, Networks, and Hacking.' },
                { id: 'megacorp',           name: 'Megacorporation Entry',          url: 'megacorp_entry.txt',          note: 'Detail Megacorporations, Entities, and Influence.' }
            ]
        },
        { category: "POST-APOCALYPTIC",
            items: [
                { id: 'postapoc',           name: 'Post-Apocalyptic Entry',         url: 'postapoc_entry.txt',          note: 'Detail Post-Apocalyptic Elements for Environments.' },
                { id: 'survival',           name: 'Survival Entry',                 url: 'survival_entry.txt',          note: 'Detail Survival Strategies, Resources, and Challenges.' },
                { id: 'mutant',             name: 'Mutant Entry',                   url: 'mutant_entry.txt',            note: 'Detail Mutated Species and Beings.' },
                { id: 'wasteland',          name: 'Wasteland Entry',                url: 'wasteland_entry.txt',         note: 'Detail Wasteland Features and Hazards.' }
            ]
        },
        {
            category: "HORROR",
            items: [
                { id: 'horror',             name: 'Horror Entry',                   url: 'horror_entry.txt',            note: 'Detail Horror Elements for Environments.' },
                { id: 'monster',            name: 'Monster Entry',                  url: 'monster_entry.txt',           note: 'Detail Monsters, Creatures, and Beings.' },
                { id: 'occult',             name: 'Occult Entry',                   url: 'occult_entry.txt',            note: 'Detail Occult Practices, Entities, and Phenomena.' },
                { id: 'haunting',           name: 'Haunting Entry',                 url: 'haunting_entry.txt',          note: 'Detail Hauntings, Spirits, and Supernatural Events.' }
            ]
        },
        {
            category: "MYSTERY",
            items: [
                { id: 'mystery',            name: 'Mystery Entry',                  url: 'mystery_entry.txt',           note: 'Detail Mystery Elements for Environments.' },
                { id: 'detective',          name: 'Detective Entry',                url: 'detective_entry.txt',         note: 'Detail Detectives, Investigators, and Sleuths.' },
                { id: 'crime',              name: 'Crime Entry',                    url: 'crime_entry.txt',             note: 'Detail Crimes, Criminals, and Cases.' },
                { id: 'clue',               name: 'Clue Entry',                     url: 'clue_entry.txt',              note: 'Detail Clues, Evidence, and Leads.' }
            ]
        },
        {
            category: "ROMANCE",
            items: [
                { id: 'romance',            name: 'Romance Entry',                  url: 'romance_entry.txt',           note: 'Detail Romance Elements for Environments.' },
                { id: 'relationship',       name: 'Relationship Entry',             url: 'relationship_entry.txt',      note: 'Detail Relationships, Dynamics, and Developments.' },
                { id: 'emotion',            name: 'Emotion Entry',                  url: 'emotion_entry.txt',           note: 'Detail Emotions, Feelings, and Expressions.' },
                { id: 'intimacy',           name: 'Intimacy Entry',                 url: 'intimacy_entry.txt',          note: 'Detail Intimacy, Connections, and Bonds.' }
            ]
        },
        {
            category: "THRILLER",
            items: [
                { id: 'thriller',           name: 'Thriller Entry',                 url: 'thriller_entry.txt',          note: 'Detail Thriller Elements for Environments.' },
                { id: 'suspense',           name: 'Suspense Entry',                 url: 'suspense_entry.txt',          note: 'Detail Suspense, Tension, and Excitement.' },
                { id: 'pursuit',            name: 'Pursuit Entry',                  url: 'pursuit_entry.txt',           note: 'Detail Pursuits, Chases, and Escapes.' },
                { id: 'conspiracy',         name: 'Conspiracy Entry',               url: 'conspiracy_entry.txt',        note: 'Detail Conspiracies, Plots, and Schemes.' }
            ]
        },
        /* Connector Modules */
        /* Somewhere down the line the templates can be extended to Domains beyond Narrative, Activity, Area, and Genre-based Modules.*/
        /* For now, they go on the pile. These are mostly beyond my Domain, and enttirely speculative.
        {
            category: "EDUCATIONAL",
            items: [
                { id: 'lesson',             name: 'Lesson Plan Entry',              url: 'lesson_entry.txt',            note: 'Detail Lesson Plans and Objectives.' },
                { id: 'curriculum',         name: 'Curriculum Entry',               url: 'curriculum_entry.txt',        note: 'Detail Curriculums and Syllabi.' },
                { id: 'assessment',         name: 'Assessment Entry',               url: 'assessment_entry.txt',        note: 'Detail Assessments and Evaluations.' }
            ]
        },
        /// We will be integrating education into the Core, but above would be that External Connector.
        { 
            category: "BUSINESS",
            items: [
                { id: 'bizplan',            name: 'Business Plan Entry',            url: 'bizplan_entry.txt',           note: 'Detail Business Plans and Strategies.' },
                { id: 'market',             name: 'Market Analysis Entry',          url: 'market_entry.txt',            note: 'Detail Market Research and Analysis.' },
                { id: 'finmodel',           name: 'Financial Model Entry',          url: 'finmodel_entry.txt',          note: 'Detail Financial Models and Projections.' }
            ]
        },
        {
            category: "LEGAL",
            items: [
                { id: 'contract',           name: 'Contract Entry',                 url: 'contract_entry.txt',          note: 'Detail Contracts, Agreements, and Terms.' },
                { id: 'policy',             name: 'Policy Entry',                   url: 'policy_entry.txt',            note: 'Detail Policies, Guidelines, and Regulations.' },
                { id: 'compliance',         name: 'Compliance Entry',               url: 'compliance_entry.txt',        note: 'Detail Compliance Standards and Procedures.' }
            ]
        },
        {
            category: "MEDICAL",
            items: [
                { id: 'medcase',            name: 'Medical Case Entry',             url: 'medcase_entry.txt',           note: 'Detail Medical Cases and Histories.' },
                { id: 'diagnosis',          name: 'Diagnosis Entry',                url: 'diagnosis_entry.txt',         note: 'Detail Diagnoses and Conditions.' },
                { id: 'treatment',          name: 'Treatment Plan Entry',          url: 'treatment_entry.txt',          note: 'Detail Treatment Plans and Protocols.' }
            ]
        },


        {
            category: "TECHNICAL",
            items: [
                { id: 'techdoc',            name: 'TechDoc Entry',                  url: 'techdoc_entry.txt',           note: 'Detail Technical Documentation and Specifications.' },
                { id: 'sysarch',            name: 'System Architecture',            url: 'sysarch_entry.txt',           note: 'Detail System Architectures and Designs.' },
                { id: 'apidoc',             name: 'API Documentation',              url: 'apidoc_entry.txt',            note: 'Detail API Endpoints and Integrations.' }
            ]
        }
        */
        /* --- ADD NEW CATEGORIES BELOW --- */
    ];

    let currentItem = null;

    function init() {
        const container = document.getElementById('accordion-container');
        
        registry.forEach(group => {
            const block = document.createElement('div');
            block.className = 'category-block';

            const header = document.createElement('div');
            header.className = 'category-header';
            header.textContent = group.category;
            
            const itemList = document.createElement('div');
            itemList.className = 'item-list';

            header.onclick = () => {
                header.classList.toggle('collapsed');
                itemList.classList.toggle('hidden');
            };

            group.items.forEach(item => {
                const navItem = document.createElement('div');
                navItem.className = 'nav-item';
                navItem.textContent = item.name;
                navItem.onclick = (e) => {
                    e.stopPropagation(); // Prevent accordion toggle when clicking item
                    loadTemplate(item, navItem);
                };
                itemList.appendChild(navItem);
            });

            block.appendChild(header);
            block.appendChild(itemList);
            container.appendChild(block);
        });
    }

    async function loadTemplate(item, element) {
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        element.classList.add('active');
        document.getElementById('active-title').textContent = item.name.toUpperCase();
        currentItem = item;
        
        try {
            const response = await fetch(item.url);
            const text = await response.text();
            document.getElementById('workbench').value = text;
        } catch (err) {
            document.getElementById('workbench').value = "Stream Error: File not found.";
        }
    }

    function popOut() {
        if (!currentItem) return;
        window.open(`Template_Popout.html?file=${currentItem.url}&name=${encodeURIComponent(currentItem.name)}`, 
                    '_blank', 'width=750,height=850');
    }

    function resetCurrent() {
        if (!currentItem) return;
        const activeNav = Array.from(document.querySelectorAll('.nav-item'))
                               .find(n => n.textContent === currentItem.name);
        loadTemplate(currentItem, activeNav);
    }

    async function copyTemplate() {
        const area = document.getElementById('workbench');
        const btn = document.getElementById('copyBtn');
        if (!area.value) return;
        try {
            await navigator.clipboard.writeText(area.value);
            btn.innerHTML = "âœ¨ COPIED";
            setTimeout(() => { btn.innerHTML = "ðŸ“‹ COPY"; }, 1200);
        } catch (err) {}
    }

    window.onload = init;
</script>

</body>
</html>